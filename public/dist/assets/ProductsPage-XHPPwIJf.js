import{_ as p,f as _,a as r,o as t,t as i,F as h,g as v,n as m,b as o,h as f,i as y}from"./index-BIMe63PN.js";import{f as k}from"./products-Cvr2MWkH.js";const P={key:0,class:"loading"},$={key:1,class:"error"},b={key:2,class:"empty"},I={key:3,class:"products-grid"},B=["onClick"],E={class:"image-container"},x=["src","onError"],A={class:"product-info"},j={class:"meta"},w={class:"category"},S={class:"manufacturer"},U={__name:"ProductsGrid",props:{products:Array,loading:Boolean,error:String},setup(n){const l=_({}),d=e=>{var u;if(l.value[e.id]||!((u=e.photos)!=null&&u.length))return"/placeholder-product.jpg";let s=e.photos[0];return s=s.replace(/^\/+/,""),`/${s}`},c=(e,s)=>{l.value[s]=!0,e.target.src="/placeholder-product.jpg",e.target.classList.add("placeholder-image")};return(e,s)=>n.loading?(t(),r("div",P,"Загрузка товаров...")):n.error?(t(),r("div",$,i(n.error),1)):n.products.length?(t(),r("div",I,[(t(!0),r(h,null,v(n.products,(a,u)=>(t(),r("div",{key:a.id,class:"product-card",onClick:g=>e.$router.push(`/products/${a.id}`),style:m({"--index":u})},[o("div",E,[o("img",{src:d(a),onError:g=>c(g,a.id),loading:"lazy"},null,40,x)]),o("div",A,[o("h3",null,i(a.name),1),o("div",j,[o("span",w,i(a.category_name),1),o("span",S,i(a.manufacturer_name),1)]),s[0]||(s[0]=o("p",{class:"price"},"Запросить цену",-1)),s[1]||(s[1]=o("button",{class:"details-btn"},"Подробнее",-1))])],12,B))),128))])):(t(),r("div",b,"Товары не найдены"))}},z=p(U,[["__scopeId","data-v-65bfeb19"]]),C={class:"products-page"},F={key:0},G={key:1,class:"error"},L={__name:"ProductsPage",setup(n){const l=_([]),d=_(!0),c=_(null);return f(async()=>{console.log("Начало загрузки продуктов");try{console.log("Перед вызовом fetchProducts");const e=await k();if(console.log("Данные получены:",e),!Array.isArray(e))throw new Error("API вернул не массив данных");l.value=e}catch(e){c.value="Не удалось загрузить товары",console.error("Ошибка загрузки:",e)}finally{d.value=!1,console.log("Загрузка завершена",{loading:d.value,error:c.value,products:l.value.length})}}),(e,s)=>(t(),r("div",C,[s[0]||(s[0]=o("h1",null,"Наши товары",-1)),d.value?(t(),r("div",F,"Загрузка...")):c.value?(t(),r("div",G,i(c.value),1)):(t(),y(z,{key:2,products:l.value},null,8,["products"]))]))}},N=p(L,[["__scopeId","data-v-a92235f3"]]);export{N as default};
